<config-template xmlns="http://tail-f.com/ns/config/1.0">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>{$DEVICE_NAME}</name>
      <config>
        <policy-map xmlns="urn:ios" tags="merge">
          <name>{$POLICY_NAME}-OUT</name>
          <class-default>
            <class>
              <name>class-default</name>
              <police-policy-map>
                <police>
                  <cir>{$POLICE_CIR}</cir>
                  <bc>{$POLICE_BC}</bc>
                  <actions>
                    <conform-set-mpls-exp-imposition-transmit>
                      <conform-action>
                        <set-mpls-exp-imposition-transmit>3</set-mpls-exp-imposition-transmit>
                      </conform-action>
                    </conform-set-mpls-exp-imposition-transmit>
                    <exceed-drop>
                      <exceed-action>
                        <drop/>
                      </exceed-action>
                    </exceed-drop>
                  </actions>
                </police>
              </police-policy-map>
            </class>
          </class-default>
        </policy-map>
        <policy-map xmlns="urn:ios" tags="merge">
          <name>{$POLICY_NAME}-IN</name>
          <class-default>
            <class>
              <name>class-default</name>
              <shape>
                <average>
                  <bit-rate>{$SHAPE_AVG}</bit-rate>
                </average>
              </shape>
            </class>
          </class-default>
        </policy-map>

        <policy-map xmlns="http://tail-f.com/ned/cisco-ios-xr" tags="merge">
          <name>{$POLICY_NAME}-OUT</name>
          <class>
            <class-default>
              <map>class-default</map>
              <police-rate-unit>
                <police>
                  <rate>
                    <cir>{$POLICE_CIR}</cir>
                    <cir-unit>bps</cir-unit>
                    <burst>{$POLICE_BC}</burst>
                    <burst-units>bytes</burst-units>
                    <peak-burst>{$POLICE_BC}</peak-burst>
                    <peak-burst-units>bytes</peak-burst-units>
                  </rate>
                </police>
              </police-rate-unit>
              <set>
                <mpls>
                  <experimental>
                    <topmost>3</topmost>
                  </experimental>
                </mpls>
                <qos-group>3</qos-group>
              </set>
            </class-default>
          </class>
        </policy-map>
        <policy-map xmlns="http://tail-f.com/ned/cisco-ios-xr" tags="merge">
          <name>{$POLICY_NAME}-IN</name>
          <class>
            <class-default>
              <map>class-default</map>
              <shape>
                <average>
                  <rate>{$SHAPE_AVG}</rate>
                  <rate-unit>bps</rate-unit>
                </average>
              </shape>
            </class-default>
          </class>
        </policy-map>
      </config>
    </device>
  </devices>
</config-template>
